<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vault - Accounts</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <a href="index.html" style="float: left; text-decoration: none;">тмЕя╕П ржлрж┐рж░рзЗ ржпрж╛ржи</a>
            <h2 style="text-align: center;">ЁЯПж ржПржХрж╛ржЙржирзНржЯрж╕ ржнрж▓рзНржЯ</h2>
        </header>

        <div class="form-group">
            <label>ржПржХрж╛ржЙржирзНржЯрзЗрж░ ржирж╛ржо:</label>
            <input type="text" id="accName" placeholder="ржпрзЗржоржи: ржиржЧржж ржЯрж╛ржХрж╛, рж╕рзЛржирж╛рж▓рзА ржмрзНржпрж╛ржВржХ, ржмрж┐ржХрж╛рж╢">
            
            <label>ржмрж░рзНрждржорж╛ржи ржмрзНржпрж╛рж▓рзЗржирзНрж╕ (рз│):</label>
            <input type="number" id="accBalance" placeholder="0.00">
            
            <button onclick="saveAccount()" id="accBtn">ржПржХрж╛ржЙржирзНржЯ ржпрзЛржЧ ржХрж░рзБржи</button>
        </div>

        <hr>
        <h3>ржЖржкржирж╛рж░ ржПржХрж╛ржЙржирзНржЯ рж╕ржорзВрж╣</h3>
        <div id="accountList">рж▓рзЛржбрж┐ржВ...</div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, push, set, onValue, remove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        // ржЖржкржирж╛рж░ рж╕ржарж┐ржХ Firebase Config
        const firebaseConfig = {
            apiKey: "AIzaSyB-6yH2CTfA4bBny99kOElCypisOAJqbeo",
            authDomain: "rj-vault-14646.firebaseapp.com",
            databaseURL: "https://rj-vault-14646-default-rtdb.firebaseio.com",
            projectId: "rj-vault-14646",
            storageBucket: "rj-vault-14646.firebasestorage.app",
            messagingSenderId: "512342363505",
            appId: "1:512342363505:web:db70675bf68e6197197ad0"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        // ржПржХрж╛ржЙржирзНржЯ рж╕рзЗржн ржХрж░рж╛
        window.saveAccount = function() {
            const name = document.getElementById('accName').value;
            const bal = parseFloat(document.getElementById('accBalance').value);
            const btn = document.getElementById('accBtn');

            if(name && !isNaN(bal)) {
                btn.disabled = true;
                const accRef = ref(db, 'accounts_data');
                const newAccRef = push(accRef);
                
                set(newAccRef, {
                    name: name,
                    balance: bal,
                    lastUpdate: new Date().toLocaleString('bn-BD')
                })
                .then(() => {
                    alert("ржПржХрж╛ржЙржирзНржЯ ржпрзБржХрзНржд рж╣рзЯрзЗржЫрзЗ!");
                    document.getElementById('accName').value = '';
                    document.getElementById('accBalance').value = '';
                    btn.disabled = false;
                })
                .catch((e) => alert("Error: " + e.message));
            } else {
                alert("рж╕ржарж┐ржХ рждржерзНржп ржжрж┐ржиред");
            }
        }

        // ржПржХрж╛ржЙржирзНржЯ рж▓рж┐рж╕рзНржЯ ржжрзЗржЦрж╛ржирзЛ
        const accListRef = ref(db, 'accounts_data');
        onValue(accListRef, (snapshot) => {
            const data = snapshot.val();
            const display = document.getElementById('accountList');
            display.innerHTML = '';
            
            if (data) {
                Object.keys(data).forEach(key => {
                    const item = data[key];
                    display.innerHTML += `
                        <div style="border: 1px solid #ddd; padding: 15px; margin-bottom: 10px; border-radius: 8px; background: #f9f9f9; position: relative;">
                            <strong style="font-size: 1.1em;">${item.name}</strong> <br>
                            <span style="color: #007bff; font-weight: bold;">ржмрзНржпрж╛рж▓рзЗржирзНрж╕: рз│${item.balance.toLocaleString()}</span> <br>
                            <small style="color: #777;">ржЖржкржбрзЗржЯ: ${item.lastUpdate}</small>
                            <button onclick="deleteAccount('${key}')" style="position:absolute; right:15px; top:15px; background:none; border:none; color:red; cursor:pointer; font-size: 1.2em;">ЁЯЧСя╕П</button>
                        </div>`;
                });
            } else {
                display.innerHTML = 'ржХрзЛржирзЛ ржПржХрж╛ржЙржирзНржЯ ржпрзБржХрзНржд ржХрж░рж╛ рж╣рзЯржирж┐ред';
            }
        });

        // ржбрж┐рж▓рж┐ржЯ ржлрж╛ржВрж╢ржи
        window.deleteAccount = function(key) {
            if(confirm("ржПржЗ ржПржХрж╛ржЙржирзНржЯржЯрж┐ ржХрж┐ ржорзБржЫрзЗ ржлрзЗрж▓рждрзЗ ржЪрж╛ржи?")) {
                remove(ref(db, 'accounts_data/' + key));
            }
        }
    </script>
</body>
</html>
