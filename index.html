<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

    const firebaseConfig = {
        apiKey: "AIzaSyB-6yH2CTfA4bBny99kOElCypisOAJqbeo",
        authDomain: "rj-vault-14646.firebaseapp.com",
        databaseURL: "https://rj-vault-14646-default-rtdb.firebaseio.com",
        projectId: "rj-vault-14646",
        storageBucket: "rj-vault-14646.firebasestorage.app",
        messagingSenderId: "512342363505",
        appId: "1:512342363505:web:db70675bf68e6197197ad0"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    if (sessionStorage.getItem('isLoggedIn') !== 'true') { window.location.href = 'login.html'; }

    onValue(ref(db, 'ledger_data'), (snapshot) => {
        let inc = 0, exp = 0;
        const data = snapshot.val();
        if (data) {
            Object.values(data).forEach(i => { if(i.cat === 'income') inc += i.amt; else exp += i.amt; });
        }
        document.getElementById('totalIncome').innerText = inc;
        document.getElementById('totalExpense').innerText = exp;
        document.getElementById('totalBalance').innerText = inc - exp;
    });
</script>
