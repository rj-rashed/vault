<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vault - Dashboard</title>
    <style>
        body { background-color: #0d1117; color: white; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 0; }
        .container { width: 90%; max-width: 600px; margin: 20px auto; }
        header { text-align: center; margin-bottom: 25px; }
        
        /* ‡¶ï‡¶æ‡¶∞‡ßç‡¶°‡¶ó‡ßÅ‡¶≤‡ßã ‡¶†‡¶ø‡¶ï ‡¶ï‡¶∞‡¶æ */
        .summary-cards { display: grid; grid-template-columns: 1fr; gap: 15px; margin-bottom: 30px; }
        .card { padding: 25px; border-radius: 12px; text-align: center; }
        .income { background: #238636; }
        .expense { background: #da3633; }
        .balance { background: #1f6feb; }
        .card h3 { margin: 0; font-size: 1.1em; opacity: 0.9; }
        .card p { margin: 10px 0 0; font-size: 1.8em; font-weight: bold; }

        /* ‡¶¨‡¶æ‡¶ü‡¶®‡¶ó‡ßÅ‡¶≤‡ßã ‡¶¨‡ßú ‡¶ï‡¶∞‡¶æ */
        .nav-menu { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .nav-btn { 
            padding: 20px 10px; background: #21262d; color: white; 
            text-decoration: none; text-align: center; border-radius: 8px; 
            border: 1px solid #30363d; font-weight: bold; font-size: 1em;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }
        .logout-btn { 
            width: 100%; margin-top: 25px; padding: 15px; 
            background: #30363d; border: none; color: #f85149; 
            border-radius: 8px; font-weight: bold; cursor: pointer; 
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1 style="margin-bottom: 5px;">üîí Vault Dashboard</h1>
            <p style="color: #8b949e; margin: 0;">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨‡ßá‡¶∞ ‡¶∏‡¶†‡¶ø‡¶ï ‡¶∏‡¶æ‡¶∞‡¶∏‡¶Ç‡¶ï‡ßç‡¶∑‡ßá‡¶™</p>
        </header>

        <div class="summary-cards">
            <div class="card income">
                <h3>‡¶Æ‡ßã‡¶ü ‡¶Ü‡ßü</h3>
                <p>‡ß≥ <span id="totalIncome">0</span></p>
            </div>
            <div class="card expense">
                <h3>‡¶Æ‡ßã‡¶ü ‡¶¨‡ßç‡¶Ø‡ßü</h3>
                <p>‡ß≥ <span id="totalExpense">0</span></p>
            </div>
            <div class="card balance">
                <h3>‡¶Ö‡¶¨‡¶∂‡¶ø‡¶∑‡ßç‡¶ü</h3>
                <p>‡ß≥ <span id="totalBalance">0</span></p>
            </div>
        </div>

        <div class="nav-menu">
            <a href="ledger.html" class="nav-btn"><span>üìù</span> ‡¶Ü‡ßü-‡¶¨‡ßç‡¶Ø‡ßü</a>
            <a href="debt.html" class="nav-btn"><span>üí∏</span> ‡¶¶‡ßá‡¶®‡¶æ-‡¶™‡¶æ‡¶ì‡¶®‡¶æ</a>
            <a href="accounts.html" class="nav-btn"><span>üè¶</span> ‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶∏</a>
            <a href="reports.html" class="nav-btn"><span>üìä</span> ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü</a>
        </div>

        <button onclick="logout()" class="logout-btn">‡¶≤‡¶ó ‡¶Ü‡¶â‡¶ü</button>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyB-6yH2CTfA4bBny99kOElCypisOAJqbeo",
            authDomain: "rj-vault-14646.firebaseapp.com",
            databaseURL: "https://rj-vault-14646-default-rtdb.firebaseio.com",
            projectId: "rj-vault-14646",
            storageBucket: "rj-vault-14646.firebasestorage.app",
            messagingSenderId: "512342363505",
            appId: "1:512342363505:web:db70675bf68e6197197ad0"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        if (sessionStorage.getItem('isLoggedIn') !== 'true') {
            window.location.href = 'login.html';
        }

        onValue(ref(db, 'ledger_data'), (snapshot) => {
            let inc = 0, exp = 0;
            const data = snapshot.val();
            if (data) {
                Object.values(data).forEach(item => {
                    const amt = parseFloat(item.amt || 0);
                    if (item.cat === 'income') inc += amt;
                    else exp += amt;
                });
            }
            document.getElementById('totalIncome').innerText = inc.toLocaleString();
            document.getElementById('totalExpense').innerText = exp.toLocaleString();
            document.getElementById('totalBalance').innerText = (inc - exp).toLocaleString();
        });

        window.logout = function() {
            sessionStorage.clear();
            window.location.href = 'login.html';
        }
    </script>
</body>
</html>
